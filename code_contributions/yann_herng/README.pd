Code contribitions by Yann Herng
